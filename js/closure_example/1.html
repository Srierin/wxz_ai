<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>防抖节流</title>
</head>

<body>
  <input type="text" id="inputA">
  <br>
  <br>
  <input type="text" id="inputB">
  <br>
  <br>

  <script>
    let inputA = document.getElementById('inputA');
    let inputB = document.getElementById('inputB');
    // google sugguest ajax api call
    function ajax(content) {
      console.log('ajax request' + content);
    }
    // 函数的参数也是函数 高阶函数
    // 通用的函数 抽象，fn 任何函数减少执行的频率
    function debounce(fn, delay) {
      //
      return function (args) {
        // 定时器会返回ID
        // fn 是自由变量
        // fn 函数也是对象
        clearTimeout(fn.id);
        fn.id = setTimeout(function () {
          fn(args);
        }, delay)
      }
    }
    inputA.addEventListener('input', function (event) {
      // 耗时性的
      // google suggext 搜索建议 如果操作太过频繁 服务器直接宕机
      // 图片懒加载 scroll + getBoundingClientRect()
      // console.log(event.target.value, '防抖');
      // 减少执行的频率 
      // 没有必要的操作 用户的意图 单词为单位
      ajax(event.target.value);
    });
    // 高阶函数 耗时函数 -> 作为闭包的自由变量
    // 返回一个新的函数 这个函数会频繁执行 但是不会频繁调用
    let debounceAjax = debounce(ajax, 200);
    inputB.addEventListener('keyup', function (event) {
      debounceAjax(event.target.value);
    })
  </script>
</body>

</html>